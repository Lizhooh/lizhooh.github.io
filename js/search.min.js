(function(){var k=window||this,i=k.BLOG.even,f=k.BLOG.$,g=f("#search"),m=f("#search-wrap"),l=f("#key"),n=f("#back"),a=f("#search-panel"),p=f("#search-result"),r=f("#search-tpl").innerHTML,h=(k.BLOG.ROOT+"/content.json").replace(/\/{2}/g,"/"),e;function b(w){if(!e){var v=new XMLHttpRequest();v.open("GET",h,true);v.onload=function(){if(this.status>=200&&this.status<300){var x=JSON.parse(this.response);e=x instanceof Array?x:x.posts;w(e)}else{console.error(this.statusText)}};v.onerror=function(){console.error(this.statusText)};v.send()}else{w(e)}}function u(v,w){return v.replace(/\{\w+\}/g,function(x){var y=x.replace(/\{|\}/g,"");return w[y]||""})}var d=k.BLOG.noop;var o=f("html");var t={show:function(){k.innerWidth<760?o.classList.add("lock-size"):d;a.classList.add("in")},hide:function(){k.innerWidth<760?o.classList.remove("lock-size"):d;a.classList.remove("in")}};function s(w){var v="";if(w.length){v=w.map(function(x){return u(r,{title:x.title,path:(x.path).replace(/\/{2}/g,"/"),date:new Date(x.date).toLocaleDateString(),tags:x.tags.map(function(y){return"<span>#"+y.name+"</span>"}).join("")})}).join("")}else{v='<li class="tips"><i class="icon icon-coffee icon-3x"></i><p>Results not found!</p></li>'}p.innerHTML=v}function q(w,v){v.lastIndex=0;return v.test(w)}function c(w,v){return q(w.title,v)||w.tags.some(function(x){return q(x.name,v)})||q(w.text,v)}function j(x){var w=this.value.trim();if(!w){return}var v=new RegExp(w.replace(/[ ]/g,"|"),"gmi");b(function(z){var y=z.filter(function(A){return c(A,v)});s(y);t.show()});x.preventDefault()}g.addEventListener(i,function(){m.classList.toggle("in");l.value="";m.classList.contains("in")?l.focus():l.blur()});n.addEventListener(i,function(){m.classList.remove("in");t.hide()});document.addEventListener(i,function(v){if(v.target.id!=="key"&&i==="click"){t.hide()}});l.addEventListener("input",j);l.addEventListener(i,j)}).call(this);
