/**
 * @Lizhooh
 * update time: 2018-05-06 11:39:35
 */

(function(o,B){var p=B.body,j=B.querySelector.bind(B),q=B.querySelectorAll.bind(B),v=j("html"),t=j("#gotop"),a=j("#menu"),b=q("#menu ul.nav > li"),z=j("#header"),y=j("#mask"),u=j("#menu-toggle"),n=j("#menu-off"),h=j("#loading"),k=o.requestAnimationFrame,s=200/(1000/60),A=Array.prototype.forEach,m=("ontouchstart" in o&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent))?"touchstart":"click",C=/micromessenger/i.test(navigator.userAgent),f=function(){},l=function(w){var d=w.offsetLeft,E=w.offsetTop;if(w.offsetParent){var D=arguments.callee(w.offsetParent);d+=D.x;E+=D.y}return{x:d,y:E}},e=!!navigator.userAgent.match(/firefox/i)||navigator.msPointerEnabled?B.documentElement:p,x=function(){return B.documentElement.scrollTop||B.body.scrollTop};var c={goTop:function(d){jQuery("html,body").animate({scrollTop:d||0},500)},toggleGotop:function(d){if(d>o.innerHeight/2){t.classList.add("in")}else{t.classList.remove("in")}},toggleMenu:function(w){var d=j("#main");if(w){a.classList.remove("hide");if(o.innerWidth<1241){y.classList.add("in");a.classList.add("show");if(C){var D=x();d.classList.add("lock");d.scrollTop=D}else{v.classList.add("lock")}}}else{a.classList.add("hide");a.classList.remove("show");y.classList.remove("in");if(C){var D=d.scrollTop;d.classList.remove("lock");e.scrollTop=D}else{v.classList.remove("lock")}}},fixedHeader:function(d){if(d>this.fixedHeaderStart){z.classList.add("fixed");if(d>=this.cacheTop+25){if(z.style.opacity>0){z.style.opacity=this.cacheOpacity-(d-this.cacheStart)/this.LEN}this.cacheEnd=this.cacheTop;this.cacheTop=d}else{if(d<=this.cacheTop-25){if(z.style.opacity<=1){z.style.opacity=this.cacheOpacity=(this.cacheEnd-d)/this.LEN}this.cacheStart=d;this.cacheTop=d}}}else{z.classList.remove("fixed");if(z.style.opacity!=1){z.style.opacity=1;this.cacheOpacity=1;this.cacheStart=z.clientHeight*3}}},toc:(function(){var E=j("#post-toc");if(!E||!E.children.length){return{fixed:f,actived:f}}var D=j(".post-header").clientHeight,d=z.clientHeight,w=j("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6");E.querySelector('a[href="#'+w[0].id+'"]').parentNode.classList.add("active");A.call(q('a[href^="#"]'),function(F){F.addEventListener("click",function(H){H.preventDefault();var G=l(j('[id="'+decodeURIComponent(this.hash).substr(1)+'"]')).y-d;c.goTop(G+30)})});return{fixed:function(F){F>=D-d?E.classList.add("fixed"):E.classList.remove("fixed")},actived:function(G){for(i=0,len=w.length;i<len;i++){if(G>l(w[i]).y-d-5){E.querySelector("li.active").classList.remove("active");var F=E.querySelector('a[href="#'+w[i].id+'"]').parentNode;F.classList.add("active")}}if(G<l(w[0]).y){E.querySelector("li.active").classList.remove("active");E.querySelector('a[href="#'+w[0].id+'"]').parentNode.classList.add("active")}}}})(),hideOnMask:[],modal:function(d){this.$modal=j(d);this.$off=this.$modal.querySelector(".close");var w=this;this.show=function(){y.classList.add("in");w.$modal.classList.add("ready");setTimeout(function(){w.$modal.classList.add("in")},0)};this.onHide=f;this.hide=function(){w.onHide();y.classList.remove("in");w.$modal.classList.remove("in");setTimeout(function(){w.$modal.classList.remove("ready")},300)};this.toggle=function(){return w.$modal.classList.contains("in")?w.hide():w.show()};c.hideOnMask.push(this.hide);this.$off&&this.$off.addEventListener(m,this.hide)},share:function(){var w=j("#pageShare"),D=j("#shareFab");var d=new this.modal("#globalShare");j("#menuShare").addEventListener(m,d.toggle);if(D){D.addEventListener(m,function(){w.classList.toggle("in")},false);B.addEventListener(m,function(F){!D.contains(F.target)&&w.classList.remove("in")},false)}var E=new this.modal("#wxShare");E.onHide=d.hide;A.call(q(".wxFab"),function(F){F.addEventListener(m,E.toggle)})},search:function(){var d=j("#search-wrap");function w(){d.classList.toggle("in")}j("#search").addEventListener(m,w)},reward:function(){var d=new this.modal("#reward");j("#rewardBtn").addEventListener(m,d.toggle)},waterfall:function(){if(o.innerWidth<760){return}A.call(q(".waterfall"),function(w){var D=w.querySelectorAll(".waterfall-item");var d=[0,0];A.call(D,function(F){var E=d[0]<=d[1]?0:1;F.style.cssText="top:"+d[E]+"px;left:"+(E>0?"50%":0);d[E]+=F.offsetHeight});w.style.height=Math.max(d[0],d[1])+"px";w.classList.add("in")})},tabBar:function(d){d.parentNode.parentNode.classList.toggle("expand")},page:(function(){var d=q(".fade, .fade-scale");var w=false;return{loaded:function(){A.call(d,function(D){D.classList.add("in")});w=true},unload:function(){A.call(d,function(D){D.classList.remove("in")});w=false},visible:w}})(),lightbox:(function(){function d(E){this.$img=E.querySelector("img");this.$overlay=E.querySelector("overlay");this.margin=40;this.title=this.$img.title||this.$img.alt||"";this.isZoom=false;var H,w,F,D,G;this.calcRect=function(){D=p.clientWidth;G=p.clientHeight;var M=G-this.margin*2;var L=H;var Q=w;var O=this.margin;var K=0;var J=L>D?D/L:1;var N=Q>M?M/Q:1;var P=Math.min(J,N);L=L*P;Q=Q*P;return{w:L,h:Q,t:(G-Q)/2-F.top,l:(D-L)/2-F.left+this.$img.offsetLeft}
};this.setImgRect=function(J){this.$img.style.cssText="width: "+J.w+"px; max-width: "+J.w+"px; height:"+J.h+"px; top: "+J.t+"px; left: "+J.l+"px"};this.setFrom=function(){this.setImgRect({w:F.width,h:F.height,t:0,l:(E.offsetWidth-F.width)/2})};this.setTo=function(){this.setImgRect(this.calcRect())};this.addTitle=function(){if(!this.title){return}this.$caption=B.createElement("div");this.$caption.innerHTML=this.title;this.$caption.className="overlay-title";E.appendChild(this.$caption)};this.removeTitle=function(){this.$caption&&E.removeChild(this.$caption)};var I=this;this.zoomIn=function(){H=this.$img.naturalWidth||this.$img.width;w=this.$img.naturalHeight||this.$img.height;F=this.$img.getBoundingClientRect();E.style.height=F.height+"px";E.classList.add("ready");this.setFrom();this.addTitle();this.$img.classList.add("zoom-in");setTimeout(function(){E.classList.add("active");I.setTo();I.isZoom=true},0)};this.zoomOut=function(){this.isZoom=false;E.classList.remove("active");this.$img.classList.add("zoom-in");this.setFrom();setTimeout(function(){I.$img.classList.remove("zoom-in");I.$img.style.cssText="";I.removeTitle();E.classList.remove("ready");E.removeAttribute("style")},300)};E.addEventListener("click",function(J){I.isZoom?I.zoomOut():J.target.tagName==="IMG"&&I.zoomIn()});B.addEventListener("scroll",function(){I.isZoom&&I.zoomOut()});o.addEventListener("resize",function(){I.isZoom&&I.zoomOut()})}A.call(q(".img-lightbox"),function(w){new d(w)})})(),loadScript:function(d){d.forEach(function(D){var w=B.createElement("script");w.src=D;w.async=true;p.appendChild(w)})}};o.addEventListener("load",function(){c.waterfall();var d=x();c.toc.fixed(d);c.toc.actived(d);h.classList.remove("active");c.page.loaded();o.lazyScripts&&o.lazyScripts.length&&c.loadScript(o.lazyScripts)});var g=false;o.addEventListener("beforeunload",function(d){if(!g){c.page.unload()}else{g=false}});o.addEventListener("pageshow",function(){!c.page.visible&&c.page.loaded()});o.addEventListener("resize",function(){o.BLOG.even=m="ontouchstart" in o?"touchstart":"click";c.toggleMenu();c.waterfall()});t.addEventListener(m,function(){k(c.goTop.bind(c,0))},false);u.addEventListener(m,function(d){c.toggleMenu(true);d.preventDefault()},false);A.call(b,function(d){d.addEventListener("click",function(w){c.toggleMenu(false);w.stopPropagation();w.preventDefault();setTimeout(function(){window.location.href=d.children[0].href},300)},false)});n.addEventListener(m,function(){a.classList.add("hide")},false);y.addEventListener(m,function(d){c.toggleMenu();c.hideOnMask.forEach(function(w){w()});d.preventDefault()},false);var r=0;B.addEventListener("scroll",function(){r=x();c.count++;if(c.count%8===0&&r>z.clientHeight*3){c.toggleGotop(r);c.fixedHeader(r);c.toc.fixed(r);c.toc.actived(r)}else{c.toggleGotop(r);c.fixedHeader(r);c.toc.fixed(r);c.toc.actived(r)}},false);if(o.BLOG.SHARE){c.share()}if(o.BLOG.REWARD){c.reward()}z.style.opacity=1;c.noop=f;c.even=m;c.fixedHeaderStart=window.innerHeight-50;c.cacheTop=window.innerHeight-50;c.cacheStart=window.innerHeight-50;c.cacheEnd=window.innerHeight-50;c.cacheOpacity=1;c.LEN=640;c.count=0;c.$=j;c.$$=q;c.fixedHeader(x());setTimeout(function(){c.toggleMenu(false)},4000);Object.keys(c).reduce(function(d,w){d[w]=c[w];return d},o.BLOG);if(o.Waves){Waves.init();Waves.attach(".global-share li",["waves-block"]);Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])}else{console.error("Waves loading failed.")}(function(w,d){var D=d(".highlight");A.call(D,function(G,E){var H=G.classList.item(1);if(G.parentNode.nodeName.toLowerCase()==="blockquote"){return}if(H!==null){var F=document.createElement("div");F.classList.add("codetype");F.classList.add(H);F.textContent=H.toUpperCase();G.appendChild(F)}})})(j,q)})(window,document);
